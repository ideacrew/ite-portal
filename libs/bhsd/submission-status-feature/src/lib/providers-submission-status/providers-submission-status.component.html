<h1>Provider Submission Overview</h1>
<div class="filters">
  <div class="filter">
    <label for="reportingPeriod">Reporting Period</label>
    <div class="filters">
      <select
        name="rpMonthFilter"
        id="rpMonthFilter"
        (change)="updateFilters('month', $event)"
      >
        <option value="">Select Month</option>
        <option
          *ngFor="let month of monthList"
          [value]="month.getMonth()"
          [selected]="rpMonthFilter - 1 === month.getMonth()"
          (change)="updateFilters('month', $event)"
        >
          {{ month | date: 'MMMM' }}
        </option>
      </select>
      <select
        name="rpYearFilter"
        id="rpYearFilter"
        (change)="updateFilters('year', $event)"
      >
        <option value="">Select Year</option>
        <option
          *ngFor="let year of yearList"
          [value]="year"
          [selected]="year.toString() === rpYearFilter.toString()"
          (change)="updateFilters('year', $event)"
        >
          {{ year }}
        </option>
      </select>
    </div>
  </div>
  <div class="filter" *ngIf="allProviders$ | async as providers">
    <label for="providerFilter">Provider</label>
    <select
      name="providerFilter"
      id="providerFilter"
      (change)="updateFilters('provider', $event)"
    >
      <option value="" disabled hidden selected>Select Provider</option>
      <option value="">See All</option>
      <option
        *ngFor="let provider of providers"
        [value]="provider.providerId"
        [selected]="
          providerFilter.toString() === provider.providerId.toString()
        "
      >
        {{ provider.providerName }}
      </option>
    </select>
  </div>
  <div class="filter">
    <label for="serviceTypeFilter">Service Type</label>
    <select
      name="serviceTypeFilter"
      id="serviceTypeFilter"
      (change)="updateFilters('serviceType', $event)"
      class="hasPlaceholder"
    >
      <option value="" disabled hidden selected>Select Service Type</option>
      <option value="">See All</option>
      <option value="MH" [selected]="serviceTypeFilter === 'MH'">MH</option>
      <option value="SUD" [selected]="serviceTypeFilter === 'SUD'">SUD</option>
      <option value="MH & SUD" [selected]="serviceTypeFilter === 'MH & SUD'">
        MH & SUD
      </option>
    </select>
  </div>
  <div class="filter">
    <label for="statusFilter">Submission Status</label>
    <select
      name="statusFilter"
      id="statusFilter"
      (change)="updateFilters('status', $event)"
      class="hasPlaceholder"
    >
      <option value="" disabled hidden selected>Select Status</option>
      <option value="">See All</option>
      <option value="Current" [selected]="statusFilter === 'Current'">
        Current
      </option>
      <option
        value="Expecting Submission"
        [selected]="statusFilter === 'Expecting Submission'"
      >
        Expecting Submission
      </option>
      <option
        value="Need Resubmission"
        [selected]="statusFilter === 'Need Resubmission'"
      >
        Need Resubmission
      </option>
      <option value="Past Due" [selected]="statusFilter === 'Past Due'">
        Past Due
      </option>
    </select>
  </div>
</div>
<div class="filters">
  <div class="filter">
    <h2>Total Records</h2>
    <div class="filters">
      <div>
        <label for="trMinFilter">Minimum Records</label>
        <input
          type="number"
          min="0"
          step="1"
          id="trMinFilter"
          name="trMinFilter"
          [value]="trMinFilter"
          oninput="validity.valid||(value='');"
          (change)="updateFilters('trMin', $event)"
        />
      </div>
      <div>
        <label for="trMaxFilter">Maximum Records</label>
        <input
          type="number"
          min="0"
          step="1"
          id="trMaxFilter"
          name="trMaxFilter"
          [value]="trMaxFilter"
          oninput="validity.valid||(value='');"
          (change)="updateFilters('trMax', $event)"
        />
      </div>
    </div>
  </div>
  <div class="filter">
    <h2>Submission Range</h2>
    <div class="filters">
      <div>
        <label for="submission-start">Start Date</label>
        <input
          type="date"
          name="submission-start"
          id="submission-start"
          [value]="submissionStartFilter"
          (change)="updateFilters('submission_start', $event)"
        />
      </div>
      <div>
        <label for="submission-end">End Date</label>
        <input
          type="date"
          name="submission-end"
          id="submission-end"
          [value]="submissionEndFilter"
          (change)="updateFilters('submission_end', $event)"
        />
      </div>
    </div>
    <p
      *ngIf="submissionStartFilter !== '' && submissionEndFilter === ''"
      class="break"
    >
      Select End Date to narrow results
    </p>
    <p
      *ngIf="submissionStartFilter === '' && submissionEndFilter !== ''"
      class="break"
    >
      Select Start Date to narrow results
    </p>
  </div>
  <div class="filter">
    <h2>Pass Rate</h2>
    <div class="filters">
      <div>
        <label for="prMinFilter">Minimum %</label>
        <input
          type="number"
          min="0"
          step="1"
          id="prMinFilter"
          name="prMinFilter"
          [value]="prMinFilter"
          oninput="validity.valid||(value='');"
          (change)="updateFilters('prMin', $event)"
        />
      </div>
      <div>
        <label for="prMaxFilter">Maximum %</label>
        <input
          type="number"
          min="0"
          step="1"
          id="prMaxFilter"
          name="prMaxFilter"
          [value]="prMaxFilter"
          oninput="validity.valid||(value='');"
          (change)="updateFilters('prMax', $event)"
        />
      </div>
    </div>
  </div>
</div>

<h2>Submission Summary</h2>
<table>
  <thead>
    <tr>
      <th>Provider Name</th>
      <th>Service Type</th>
      <th>Submission Status</th>
      <th>Submitted On</th>
      <th>Total Records</th>
      <th>Pass</th>
      <th>Fail</th>
      <th>Pass Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let submission of submissionStatus$ | async">
      <td>
        <a
          [routerLink]="[
            '/provider-gateway/provider-profile',
            submission.providerId
          ]"
          >{{ submission.providerName }}</a
        >
      </td>
      <td class="service-type">
        {{ serviceType(submission) }}
      </td>
      <td>{{ submission.status }}</td>
      <td>
        <a
          *ngIf="submission.extractId !== undefined"
          [routerLink]="['/provider-gateway/submissions', submission.extractId]"
          >{{
            submission.submittedOn === undefined
              ? 'N/A'
              : (submission.submittedOn | date)
          }}
        </a>
        <span *ngIf="submission.extractId === undefined">N/A</span>
      </td>
      <td>{{ submission.totalRecords ?? 'N/A' }}</td>
      <td>{{ submission.pass ?? 'N/A' }}</td>
      <td>{{ submission.fail ?? 'N/A' }}</td>
      <td>{{ submission | passRate }}</td>
    </tr>
  </tbody>
</table>
